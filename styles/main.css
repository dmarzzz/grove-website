/* ============================================================
   The Grove — Stylesheet
   A research organism in a former Catholic school.
   Manuscript page treatment with dark marble frame.
   ============================================================ */


/* — Palette — */
:root {
  /* Scroll-paper tones */
  --color-bg:           #efe5d0;
  --color-bg-warm:      #e8dcc6;
  --color-bg-panel:     #f2ead8;

  /* Text hierarchy — warm near-black to gray */
  --color-text:         #1c1912;
  --color-text-body:    #302d24;
  --color-text-soft:    #5a5648;
  --color-text-muted:   #6d6552;
  --color-text-ghost:   #8f856f;

  /* Accent — gold-olive (erdtree-touched) */
  --color-accent:       #5a6038;
  --color-accent-dark:  #3e4428;

  /* Structural rules — warm gold */
  --color-rule:         #c0ad88;
  --color-rule-light:   #d4c5a4;
  --color-rule-faint:   #e2d8c4;

  /* Selection */
  --color-selection-bg:   #d4c5a4;
  --color-selection-text: #1c1912;
  --color-focus:          #4b5a32;
}


/* — Typography — */
:root {
  --font-display: 'Cormorant Garamond', Georgia, serif;
  --font-body:    'Inter', 'Helvetica Neue', sans-serif;
  --font-mono:    'JetBrains Mono', 'Courier New', monospace;

  --size-display: clamp(3.5rem, 7.5vw, 6rem);
  --size-h2:      clamp(1.35rem, 2.2vw, 1.75rem);
  --size-h3:      clamp(1.05rem, 1.3vw, 1.2rem);
  --size-body:    clamp(0.9375rem, 1.05vw, 1.0625rem);
  --size-small:   clamp(0.8125rem, 0.92vw, 0.875rem);
  --size-tiny:    clamp(0.6875rem, 0.78vw, 0.75rem);

  --leading-body:  1.62;
  --leading-tight: 1.2;

  --tracking-display: 0.08em;
  --tracking-caps:    0.14em;
}


/* — Layout — */
:root {
  --content-narrow: 640px;
  --content-wide:   1060px;
  --section-pad-y:  clamp(3rem, 6vh, 5rem);
  --section-pad-x:  clamp(1.5rem, 4vw, 2.5rem);

  /* Manuscript frame dimensions */
  --frame:        clamp(18px, 2.8vmin, 38px);
  --inner-inset:  clamp(12px, 1.8vmin, 24px);
}


/* — Reset — */
*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  height: 100%;
  overflow: hidden;
  -webkit-text-size-adjust: 100%;

  /* ═══ Dark Green Marble / Malachite Background ═══ */
  background:
    /* Fine veining lines */
    repeating-linear-gradient(
      138deg,
      transparent 0px,
      transparent 20px,
      rgba(45,85,50,0.07) 20px,
      rgba(45,85,50,0.07) 21px
    ),
    repeating-linear-gradient(
      112deg,
      transparent 0px,
      transparent 28px,
      rgba(55,95,60,0.05) 28px,
      rgba(55,95,60,0.05) 29px
    ),
    /* Cloud veining */
    radial-gradient(ellipse at 15% 30%, rgba(35,72,40,0.45) 0%, transparent 50%),
    radial-gradient(ellipse at 78% 12%, rgba(22,58,28,0.5) 0%, transparent 45%),
    radial-gradient(ellipse at 88% 72%, rgba(32,68,38,0.35) 0%, transparent 42%),
    radial-gradient(ellipse at 38% 88%, rgba(28,62,32,0.42) 0%, transparent 48%),
    radial-gradient(ellipse at 58% 48%, rgba(42,78,48,0.2) 0%, transparent 58%),
    /* Lighter veins */
    radial-gradient(ellipse at 28% 62%, rgba(60,105,68,0.12) 0%, transparent 28%),
    radial-gradient(ellipse at 68% 38%, rgba(55,98,62,0.1) 0%, transparent 22%),
    /* Base gradient — deep polished stone */
    linear-gradient(148deg, #18361f, #0d2414, #15301d, #0b2112, #132c1b);
}


/* — Base — */
body {
  height: 100%;
  overflow: hidden;
  font-family: var(--font-body);
  font-size: var(--size-body);
  line-height: var(--leading-body);
  color: var(--color-text-body);
  background: transparent;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  font-feature-settings: 'kern' 1, 'liga' 1;
  font-variant-ligatures: common-ligatures;
}

a {
  color: var(--color-accent-dark);
}

a:focus-visible,
button:focus-visible,
[tabindex]:focus-visible {
  outline: 2px solid var(--color-focus);
  outline-offset: 3px;
}

.skip-link {
  position: fixed;
  left: 1rem;
  top: 1rem;
  z-index: 11000;
  padding: 0.45rem 0.7rem;
  border: 1px solid var(--color-rule);
  background: var(--color-bg-panel);
  color: var(--color-text);
  font-family: var(--font-body);
  font-size: 0.8rem;
  text-decoration: none;
  transform: translateY(-180%);
  transition: transform 0.2s ease;
}

.skip-link:focus {
  transform: translateY(0);
}

.site-rail {
  position: fixed;
  top: 50%;
  right: calc(var(--frame) + 8px);
  transform: translateY(-50%);
  z-index: 140;
  display: flex;
  flex-direction: column;
  gap: 0.2rem;
  padding: 0.3rem;
  background: rgba(239, 229, 208, 0.82);
  border: 1px solid rgba(168, 144, 60, 0.4);
  border-radius: 2px;
  backdrop-filter: blur(2px);
  -webkit-backdrop-filter: blur(2px);
}

.site-rail__link {
  display: block;
  padding: 0.32rem 0.48rem;
  font-family: var(--font-mono);
  font-size: 0.62rem;
  letter-spacing: 0.08em;
  color: var(--color-text-muted);
  text-transform: uppercase;
  text-decoration: none;
  border-radius: 1px;
}

.site-rail__link.is-active {
  color: var(--color-text);
  background: rgba(192, 173, 136, 0.3);
}


/* ============================================================
   MANUSCRIPT PAGE — Scrolling parchment container
   ============================================================ */
.page {
  position: fixed;
  top: calc(var(--frame) + env(safe-area-inset-top, 0px));
  left: calc(var(--frame) + env(safe-area-inset-left, 0px));
  right: calc(var(--frame) + env(safe-area-inset-right, 0px));
  bottom: calc(var(--frame) + env(safe-area-inset-bottom, 0px));
  z-index: 1;

  overflow-y: auto;
  overflow-x: hidden;
  scroll-snap-type: y proximity;
  scroll-behavior: smooth;

  /* ═══ Gilt edge — gold leaf border molding ═══ */
  border: 4px solid #b49545;

  /* Scroll paper with age stains and fiber texture */
  background:
    /* Horizontal fiber grain (papyrus/scroll feel) */
    repeating-linear-gradient(
      0deg,
      transparent 0px,
      transparent 3px,
      rgba(160,135,85,0.025) 3px,
      rgba(160,135,85,0.025) 4px
    ),
    /* Subtle vertical cross-fibers */
    repeating-linear-gradient(
      90deg,
      transparent 0px,
      transparent 8px,
      rgba(145,120,70,0.012) 8px,
      rgba(145,120,70,0.012) 9px
    ),
    /* Age/water stains — larger, warmer, more visible */
    radial-gradient(ellipse at 15% 10%, rgba(170,130,65,0.14) 0%, transparent 50%),
    radial-gradient(ellipse at 85% 15%, rgba(155,115,55,0.10) 0%, transparent 45%),
    radial-gradient(ellipse at 75% 80%, rgba(165,125,60,0.12) 0%, transparent 48%),
    radial-gradient(ellipse at 5% 75%, rgba(145,105,45,0.09) 0%, transparent 38%),
    radial-gradient(ellipse at 45% 40%, rgba(150,118,58,0.06) 0%, transparent 50%),
    radial-gradient(ellipse at 60% 20%, rgba(140,110,50,0.05) 0%, transparent 30%),
    radial-gradient(ellipse at 30% 65%, rgba(160,125,60,0.07) 0%, transparent 35%),
    /* Edge darkening — scroll edges darken naturally */
    radial-gradient(ellipse at center, transparent 30%, rgba(110,88,45,0.12) 100%),
    /* Base scroll paper */
    var(--color-bg);

  /* Depth: gilt glow, inset vignette, heavy drop shadow */
  box-shadow:
    inset 0 0 0 1px rgba(180,160,120,0.15),      /* Inner gold hairline */
    inset 0 0 120px rgba(100,80,35,0.12),          /* Deep vignette */
    inset 0 0 40px rgba(80,65,30,0.06),             /* Secondary vignette */
    0 0 0 1px rgba(80,60,20,0.25),                  /* Outer dark hairline */
    0 4px 30px rgba(0,0,0,0.35),                    /* Primary drop shadow */
    0 0 80px rgba(0,0,0,0.18),                      /* Ambient shadow */
    0 0 20px rgba(180,150,70,0.15);                  /* Gilt glow onto marble */
}

.page:focus-visible {
  outline: 3px solid var(--color-focus);
  outline-offset: -3px;
}

/* Scroll paper grain texture — coarser, more visible */
.page::after {
  content: '';
  position: fixed;
  top: calc(var(--frame) + env(safe-area-inset-top, 0px));
  left: calc(var(--frame) + env(safe-area-inset-left, 0px));
  right: calc(var(--frame) + env(safe-area-inset-right, 0px));
  bottom: calc(var(--frame) + env(safe-area-inset-bottom, 0px));
  opacity: 0.06;
  pointer-events: none;
  mix-blend-mode: multiply;
  z-index: 9999;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='5' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
}

/* Marble grain texture (covers whole viewport including frame) */
body::after {
  content: '';
  position: fixed;
  inset: 0;
  opacity: 0.025;
  pointer-events: none;
  mix-blend-mode: overlay;
  z-index: 10000;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
}


/* ============================================================
   ORNAMENTAL FRAME — Double-rule with corner flourishes
   ============================================================ */
.page-frame {
  position: fixed;
  top: calc(var(--frame) + var(--inner-inset) + env(safe-area-inset-top, 0px));
  left: calc(var(--frame) + var(--inner-inset) + env(safe-area-inset-left, 0px));
  right: calc(var(--frame) + var(--inner-inset) + env(safe-area-inset-right, 0px));
  bottom: calc(var(--frame) + var(--inner-inset) + env(safe-area-inset-bottom, 0px));
  border: 1.5px solid #a8903c;
  pointer-events: none;
  z-index: 100;
  opacity: 1;
}

/* Inner second rule for double-line effect */
.page-frame::before {
  content: '';
  position: absolute;
  inset: 5px;
  border: 1px solid #a8903c;
  opacity: 0.7;
}

/* Corner flourish SVGs */
.frame-corner {
  position: absolute;
  overflow: visible;
}

.frame-corner--tl { top: -14px; left: -14px; }
.frame-corner--tr { top: -14px; right: -14px; transform: scaleX(-1); }
.frame-corner--bl { bottom: -14px; left: -14px; transform: scaleY(-1); }
.frame-corner--br { bottom: -14px; right: -14px; transform: scale(-1); }

/* Side diamond ornaments */
.frame-diamond {
  position: absolute;
}

.frame-diamond--top    { top: -10px;   left: 50%; transform: translateX(-50%); }
.frame-diamond--bottom { bottom: -10px; left: 50%; transform: translateX(-50%); }
.frame-diamond--left   { left: -10px;  top: 50%;  transform: translateY(-50%); }
.frame-diamond--right  { right: -10px; top: 50%;  transform: translateY(-50%); }


/* ============================================================
   MARGINALIA — Cybernetic growth system emerging from corners
   ============================================================ */
.marginalia {
  position: absolute;
  inset: 0;
  overflow: visible;
  pointer-events: none;
}

.marginalia path,
.marginalia circle,
.marginalia line {
  stroke: #a8903c;
  fill: none;
  stroke-linecap: round;
  stroke-linejoin: round;
}

/* Primary vine/dendrite paths — depth-based weight */
.marginalia__vine--d0 { opacity: 0.75; stroke-width: 1.6; }
.marginalia__vine--d1 { opacity: 0.65; stroke-width: 1.3; }
.marginalia__vine--d2 { opacity: 0.50; stroke-width: 1.0; }
.marginalia__vine--d3 { opacity: 0.38; stroke-width: 0.7; }
.marginalia__vine--d4 { opacity: 0.28; stroke-width: 0.5; }

/* Sacred geometry nodes */
.marginalia__node {
  opacity: 0.55;
  stroke-width: 0.8;
}

/* Architectural grid traces */
.marginalia__grid {
  opacity: 0.28;
  stroke-width: 0.5;
  stroke-dasharray: 3 5;
}

/* Mycelium terminal filaments */
.marginalia__filament {
  opacity: 0.25;
  stroke-width: 0.4;
}

/* Draw-in animation — each path is a single continuous curve */
@keyframes drawMarginalia {
  from { stroke-dashoffset: var(--path-len); }
  to   { stroke-dashoffset: 0; }
}

@keyframes fadeMarginalia {
  from { opacity: 0; }
  to   { opacity: 1; }
}

.marginalia__draw {
  stroke-dasharray: var(--path-len);
  stroke-dashoffset: var(--path-len);
  animation: drawMarginalia var(--draw-dur, 2s) ease-out var(--draw-delay, 0s) forwards;
}

.marginalia__fade-in {
  opacity: 0;
  animation: fadeMarginalia 1.5s ease-out var(--fade-delay, 2s) forwards;
}

/* Post-draw ambient animations */
@keyframes breatheNode {
  0%, 100% { opacity: 0.45; }
  50%      { opacity: 0.75; }
}

@keyframes driftFilament {
  0%, 100% { opacity: 0.18; }
  50%      { opacity: 0.38; }
}

@keyframes pulseVine {
  0%, 100% { opacity: var(--pulse-base, 0.65); }
  50%      { opacity: var(--pulse-peak, 0.85); }
}

.marginalia__breathe {
  animation: breatheNode var(--breathe-dur, 8s) ease-in-out infinite;
}

.marginalia__drift {
  animation: driftFilament var(--drift-dur, 10s) ease-in-out infinite;
}

.marginalia__pulse {
  animation: pulseVine var(--pulse-dur, 14s) ease-in-out infinite;
}

/* Reduced motion: skip all animation, show final state */
@media (prefers-reduced-motion: reduce) {
  .marginalia__draw {
    animation: none;
    stroke-dashoffset: 0;
  }
  .marginalia__fade-in {
    animation: none;
    opacity: 1;
  }
  .marginalia__breathe,
  .marginalia__drift,
  .marginalia__pulse {
    animation: none;
  }
}

/* Hide on tablet/mobile (same breakpoint as corners/diamonds) */
@media (max-width: 900px) {
  .marginalia {
    display: none;
  }
}


/* — Selection — */
::selection {
  background: var(--color-selection-bg);
  color: var(--color-selection-text);
}


/* — Scrollbar (on .page) — */
.page::-webkit-scrollbar       { width: 5px; }
.page::-webkit-scrollbar-track  { background: transparent; }
.page::-webkit-scrollbar-thumb  { background: var(--color-rule-light); border-radius: 3px; }
.page::-webkit-scrollbar-thumb:hover { background: var(--color-rule); }


/* — Sections — */
.section {
  padding: var(--section-pad-y) var(--section-pad-x);
  position: relative;
  overflow: hidden;
}

/* Hero gets full height + snap */
.section--hero {
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  scroll-snap-align: start;
  scroll-snap-stop: always;
}


/* ============================================================
   RESEARCH CONTENT — Long-form reading sections
   ============================================================ */

/* Bucket accent colors */
:root {
  --color-instrument: #6B4226;
  --color-library:    #4A6741;
  --color-observatory:#4A5568;
}

/* Reading section — flowing content, no snap */
.reading {
  max-width: var(--content-wide);
  margin: 0 auto;
  padding: clamp(2rem, 4vh, 3.5rem) var(--section-pad-x);
}

.reading p {
  font-family: var(--font-display);
  font-size: clamp(1rem, 1.15vw, 1.15rem);
  line-height: 1.72;
  color: var(--color-text-body);
  margin-bottom: 1.25em;
  max-width: 660px;
  font-weight: 400;
  letter-spacing: 0.003em;
}

.reading p:last-child {
  margin-bottom: 0;
}

.reading__header {
  margin-bottom: 1rem;
}

.reading__kicker {
  font-family: var(--font-mono);
  font-size: 0.67rem;
  color: var(--color-text-muted);
  letter-spacing: 0.12em;
  text-transform: uppercase;
  font-weight: 500;
}

.reading__who {
  font-size: clamp(0.93rem, 1.02vw, 1rem) !important;
  line-height: 1.62 !important;
  color: var(--color-text-soft) !important;
  max-width: 700px !important;
}

.reading__lead {
  font-weight: 600;
  color: var(--color-text);
  margin-bottom: 0.5em !important;
}

.reading__koan {
  font-style: italic;
  color: var(--color-text-soft);
}

/* Content divider */
.content-divider {
  text-align: center;
  margin: clamp(2.5rem, 5vh, 4rem) 0;
  font-family: var(--font-display);
  font-size: 0.875rem;
  color: var(--color-text-ghost);
  letter-spacing: 0.22em;
  user-select: none;
}

/* Bucket header — dark block with colored bar */
.bucket-header {
  background: #2C2620;
  padding: clamp(1.5rem, 3vh, 2.5rem) clamp(1.5rem, 3vw, 2.5rem);
  margin: 0 0 clamp(2rem, 4vh, 3rem);
}

.bucket-header__inner {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.bucket-header__bar {
  width: 4px;
  height: 48px;
  border-radius: 2px;
  flex-shrink: 0;
}

.bucket-header__name {
  font-family: var(--font-display);
  font-size: clamp(1.6rem, 2.8vw, 2rem);
  color: #F5F0E8;
  font-weight: 700;
  letter-spacing: 0.02em;
  line-height: 1.1;
}

.bucket-header__sub {
  font-family: var(--font-display);
  font-size: clamp(1rem, 1.4vw, 1.25rem);
  font-style: italic;
  margin-top: 4px;
}

/* Sub-section header */
.sub-header {
  font-family: var(--font-display);
  font-size: clamp(1.1rem, 1.3vw, 1.3rem);
  font-weight: 700;
  margin: clamp(2rem, 4vh, 2.75rem) 0 1rem;
  letter-spacing: 0.01em;
}

/* Research goal block */
.goal {
  margin: 0 0 1.75rem;
  max-width: 660px;
  padding-left: 1.125rem;
  border-left: 2px solid var(--color-rule-faint);
}

.goal__title {
  font-family: var(--font-display);
  font-size: clamp(0.95rem, 1.1vw, 1.0625rem);
  font-weight: 700;
  color: var(--color-text);
  margin-bottom: 0.375rem;
}

.goal__body {
  font-family: var(--font-display);
  font-size: clamp(0.9rem, 1.0vw, 1rem);
  line-height: 1.65;
  color: var(--color-text-soft);
}

.goal__question {
  display: flex;
  gap: 0.5rem;
  align-items: flex-start;
  margin-top: 0.625rem;
}

.goal__question-arrow {
  color: var(--color-accent);
  font-style: italic;
  font-size: 0.9375rem;
  flex-shrink: 0;
  margin-top: 1px;
}

.goal__question span:last-child {
  font-family: var(--font-display);
  font-size: clamp(0.875rem, 1vw, 0.96875rem);
  line-height: 1.55;
  color: var(--color-text-soft);
  font-style: italic;
}

.goal__artifact {
  display: flex;
  gap: 0.5rem;
  align-items: flex-start;
  margin-top: 0.5rem;
  background: rgba(210, 195, 170, 0.3);
  padding: 0.625rem 0.875rem;
  border-radius: 2px;
}

.goal__artifact-label {
  font-family: var(--font-mono);
  font-size: 0.625rem;
  color: var(--color-accent);
  letter-spacing: 0.1em;
  flex-shrink: 0;
  margin-top: 3px;
  font-weight: 600;
}

.goal__artifact span:last-child {
  font-family: var(--font-display);
  font-size: clamp(0.84375rem, 0.95vw, 0.9375rem);
  line-height: 1.5;
  color: var(--color-text);
  font-weight: 600;
}

/* Cryptographic substrate block */
.crypto-block {
  background: #1E1B17;
  padding: clamp(1.25rem, 2.5vh, 1.625rem) clamp(1.5rem, 2.5vw, 1.875rem);
  margin: 2rem 0 0;
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 0.75rem 2rem;
}

.crypto-block__label {
  font-family: var(--font-mono);
  font-size: 0.65rem;
  letter-spacing: 0.14em;
  color: #7A7468;
  font-weight: 600;
  margin-bottom: 0.25rem;
  grid-column: 1 / -1;
}

.crypto-item {
  margin: 0 0 0.875rem;
  display: flex;
  gap: 0.5rem;
  align-items: flex-start;
}

.crypto-item:last-child {
  margin-bottom: 0;
}

.crypto-item__diamond {
  color: var(--color-accent);
  font-size: 0.75rem;
  margin-top: 3px;
  flex-shrink: 0;
}

.crypto-item__name {
  font-family: var(--font-display);
  font-size: clamp(0.875rem, 0.98vw, 0.96875rem);
  font-weight: 700;
  color: #D4CEBC;
}

.crypto-item__sep {
  margin: 0 0.375rem;
  color: #5A5448;
}

.crypto-item__desc {
  font-family: var(--font-display);
  font-size: clamp(0.875rem, 0.98vw, 0.96875rem);
  line-height: 1.55;
  color: #9A9488;
}

/* Standalone research question */
.rq {
  margin: 0 0 0.625rem 1.375rem;
  max-width: 620px;
  display: flex;
  gap: 0.5rem;
  align-items: flex-start;
}

.rq__arrow {
  color: var(--color-accent);
  font-style: italic;
  font-size: 1rem;
  margin-top: 1px;
  flex-shrink: 0;
}

.rq span:last-child {
  font-family: var(--font-display);
  font-size: 1rem;
  line-height: 1.55;
  color: var(--color-text-soft);
  font-style: italic;
}

/* Compound visual — three-box cycle diagram */
.compound {
  margin: 1.5rem 0 0.5rem;
}

.compound__track {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0;
}

.compound__box {
  border: 1px solid var(--color-rule);
  padding: 0.875rem 1.25rem;
  text-align: center;
  flex: 1;
  max-width: 240px;
  background: rgba(226, 216, 196, 0.25);
}

.compound__name {
  font-family: var(--font-display);
  font-size: clamp(0.9rem, 1.1vw, 1.05rem);
  font-weight: 700;
  color: var(--color-text);
  letter-spacing: 0.02em;
}

.compound__verb {
  font-family: var(--font-display);
  font-size: clamp(0.8rem, 0.95vw, 0.9rem);
  font-style: italic;
  margin-top: 2px;
}

.compound__arrow {
  font-family: var(--font-display);
  font-size: 1.25rem;
  color: var(--color-text-muted);
  padding: 0 0.75rem;
  flex-shrink: 0;
}

.compound__return {
  height: 14px;
  width: 70%;
  max-width: 520px;
  margin: 0 auto;
  border-left: 1px solid var(--color-rule-faint);
  border-right: 1px solid var(--color-rule-faint);
  border-bottom: 1px solid var(--color-rule-faint);
  border-radius: 0 0 3px 3px;
}

.compound__caption {
  text-align: center;
  margin-top: 0.75rem;
}

.compound__caption em {
  font-family: var(--font-display);
  font-size: clamp(0.875rem, 1vw, 0.96rem);
  color: var(--color-text-soft);
}

/* Outputs grid — What Comes Out 3-column */
.outputs-label {
  font-family: var(--font-mono);
  font-size: 0.65rem;
  letter-spacing: 0.14em;
  color: var(--color-text-muted);
  margin-bottom: 1.25rem;
}

.outputs-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem 2rem;
}

.outputs-grid__label {
  font-family: var(--font-display);
  font-size: clamp(0.85rem, 1vw, 0.95rem);
  font-weight: 700;
  letter-spacing: 0.02em;
  margin-bottom: 0.375rem;
}

.outputs-grid p {
  font-family: var(--font-display);
  font-size: clamp(0.875rem, 1vw, 0.96rem);
  line-height: 1.6;
  color: var(--color-text-soft);
  max-width: none;
  margin-bottom: 0;
}

.closing__compound-output {
  font-style: italic;
  color: var(--color-text-soft);
  text-align: center;
  max-width: none !important;
  margin: 2rem 0 !important;
}

.closing__final {
  font-weight: 600;
  color: var(--color-text);
}

.proof-strip {
  max-width: 820px;
  margin: 1.5rem 0;
  padding: 0.95rem 1rem 1rem;
  border: 1px solid var(--color-rule-faint);
  background: rgba(226, 216, 196, 0.22);
}

.proof-strip__label {
  font-family: var(--font-mono);
  font-size: 0.62rem;
  color: var(--color-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.11em;
  margin-bottom: 0.6rem;
}

.proof-strip__items {
  display: flex;
  flex-wrap: wrap;
  gap: 0.55rem 1rem;
}

.proof-strip__items a {
  font-family: var(--font-display);
  font-size: 0.93rem;
  color: var(--color-accent-dark);
  text-decoration-thickness: 1px;
}

.cta-row {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  margin: 1.5rem 0 0.4rem;
}

.cta {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-height: 2.35rem;
  padding: 0.5rem 0.9rem;
  border-radius: 2px;
  font-family: var(--font-body);
  font-size: 0.81rem;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  text-decoration: none;
}

.cta--primary {
  border: 1px solid var(--color-accent);
  background: var(--color-accent);
  color: #f6f0df;
}

.cta--secondary {
  border: 1px solid var(--color-rule);
  background: transparent;
  color: var(--color-text);
}

.site-footer {
  text-align: center;
  font-family: var(--font-display);
  font-size: var(--size-tiny);
  color: var(--color-text-muted);
  letter-spacing: 0.06em;
  line-height: 1.75;
  padding-bottom: 5rem;
}

/* Bucket preview grid — 3 columns on desktop */
.bucket-preview-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  margin: 2rem 0 1rem;
}

/* Research question grid — side by side */
.rq-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 0.5rem 2rem;
  margin: 0.5rem 0;
}

.rq-grid .rq {
  margin: 0;
  max-width: none;
}

/* Programs grid — Observatory 3-column layout */
.programs-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem 2rem;
  margin: 0.5rem 0 0;
}

.programs-grid .sub-header {
  margin-top: 0;
  font-size: clamp(1rem, 1.2vw, 1.15rem);
}

.programs-grid p {
  font-size: clamp(0.9rem, 1.0vw, 0.96875rem) !important;
  line-height: 1.62;
  max-width: none;
}

.programs-grid .rq {
  margin-left: 0;
  max-width: none;
}

.programs-grid .rq span:last-child {
  font-size: clamp(0.875rem, 0.95vw, 0.9375rem);
}

/* Output/byproduct item */
.output-item {
  margin: 0 0 1rem 1.25rem;
  max-width: 630px;
  display: flex;
  gap: 0.5rem;
  align-items: flex-start;
}

.output-item__diamond {
  color: var(--color-accent);
  font-size: 0.8125rem;
  margin-top: 3px;
  flex-shrink: 0;
}

.output-item__name {
  font-family: var(--font-display);
  font-size: 1rem;
  font-weight: 700;
  color: var(--color-text);
}

.output-item__sep {
  margin: 0 0.375rem;
  color: var(--color-text-ghost);
}

.output-item__desc {
  font-family: var(--font-display);
  font-size: 1rem;
  line-height: 1.6;
  color: var(--color-text-soft);
}

/* Timeline row */
.tl-phase {
  font-family: var(--font-display);
  font-size: clamp(0.95rem, 1.1vw, 1.0625rem);
  font-weight: 700;
  margin: 1.5rem 0 0.75rem 1.25rem;
}

.tl-row {
  margin: 0 0 0.75rem 1.25rem;
  font-family: var(--font-display);
  font-size: clamp(0.84375rem, 0.96vw, 0.9375rem);
  line-height: 1.6;
  color: var(--color-text-soft);
  padding-left: 0.75rem;
  border-left: 1px solid var(--color-rule-faint);
}

/* Budget table */
.budget-table {
  width: 100%;
  max-width: 560px;
  border-collapse: collapse;
  font-family: var(--font-display);
  font-size: clamp(0.8125rem, 0.92vw, 0.9rem);
  margin: 1.5rem 0;
}

.budget-table thead tr {
  border-bottom: 1.5px solid var(--color-text);
}

.budget-table th {
  padding: 0.375rem 0.75rem;
  font-weight: 600;
  font-size: 0.75rem;
  letter-spacing: 0.04em;
  color: var(--color-text);
}

.budget-table th:not(:first-child) {
  text-align: right;
}

.budget-table td {
  padding: 0.5rem 0.75rem;
  color: var(--color-text-soft);
}

.budget-table td:first-child {
  font-weight: 600;
  color: var(--color-text);
}

.budget-table td:not(:first-child) {
  text-align: right;
}

.budget-table tbody tr {
  border-bottom: 0.5px solid var(--color-rule-faint);
}

.budget-table tfoot tr {
  border-top: 1.5px solid var(--color-text);
}

.budget-table tfoot td {
  font-weight: 700;
  color: var(--color-text);
}

/* Blockquote with left border */
.content-blockquote {
  border-left: 2px solid var(--color-library);
  padding-left: 1.5rem;
  margin: 1.5rem 0 2rem 0.25rem;
  max-width: 630px;
}

.content-blockquote p {
  color: var(--color-text-soft);
  font-size: clamp(0.9rem, 1.03vw, 1.03rem);
}

/* Bucket preview in preamble */
.bucket-preview {
  display: flex;
  gap: 1rem;
  align-items: flex-start;
  margin-bottom: 1.125rem;
}

.bucket-preview__bar {
  width: 4px;
  min-height: 44px;
  border-radius: 2px;
  flex-shrink: 0;
  margin-top: 2px;
}

.bucket-preview__name {
  font-family: var(--font-display);
  font-size: clamp(1.05rem, 1.2vw, 1.2rem);
  font-weight: 700;
  color: var(--color-text);
  letter-spacing: 0.02em;
}

.bucket-preview__desc {
  font-family: var(--font-display);
  font-size: clamp(0.84375rem, 0.96vw, 0.9375rem);
  font-style: italic;
  margin-top: 2px;
}

/* Cross ornament */
.cross-ornament {
  text-align: center;
  font-size: 1.5rem;
  color: var(--color-text-ghost);
  opacity: 0.35;
  user-select: none;
}

/* Research reading responsive */
@media (max-width: 900px) {
  .site-rail {
    right: auto;
    left: 50%;
    top: auto;
    bottom: calc(var(--frame) + 14px);
    transform: translateX(-50%);
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.18rem;
    max-width: min(92vw, 580px);
  }

  .site-rail__link {
    font-size: 0.57rem;
    padding: 0.26rem 0.42rem;
  }

  .bucket-header {
    margin-left: calc(-1 * var(--section-pad-x));
    margin-right: calc(-1 * var(--section-pad-x));
  }

  .crypto-block {
    margin-left: calc(-1 * var(--section-pad-x));
    margin-right: calc(-1 * var(--section-pad-x));
    grid-template-columns: 1fr;
  }

  .bucket-preview-grid,
  .rq-grid,
  .programs-grid,
  .outputs-grid {
    grid-template-columns: 1fr;
  }

  .proof-strip {
    margin-left: calc(-1 * var(--section-pad-x));
    margin-right: calc(-1 * var(--section-pad-x));
    border-left: none;
    border-right: none;
  }

  .cta-row {
    gap: 0.6rem;
  }

  .cta {
    flex: 1;
    min-width: 180px;
  }

  .compound__track {
    flex-direction: column;
    align-items: stretch;
  }

  .compound__box {
    max-width: none;
  }

  .compound__arrow {
    text-align: center;
    padding: 0.25rem 0;
    transform: rotate(90deg);
  }

  .compound__return {
    display: none;
  }
}


/* ============================================================
   HERO
   ============================================================ */
.section--hero {
  text-align: center;
}

/* Subtle radial glow behind hero content */
.section--hero::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(ellipse at center, rgba(255, 253, 248, 0.5) 0%, transparent 60%);
  pointer-events: none;
}

.hero__content {
  position: relative;
  z-index: 1;
}

/* — Point Cloud (canvas, driven by JS) — */
.hero__cloud {
  width: clamp(200px, 32vw, 380px);
  height: clamp(200px, 32vw, 380px);
  margin: 0 auto 1rem;
  display: block;
}

.hero__title {
  font-family: var(--font-display);
  font-size: var(--size-display);
  font-weight: 600;
  letter-spacing: var(--tracking-display);
  line-height: var(--leading-tight);
  margin-bottom: 1.25rem;

  /* Constant gold text with pulsing holographic glow */
  background: linear-gradient(
    135deg,
    var(--color-text) 20%,
    #7a6b45 50%,
    var(--color-text) 80%
  );
  background-size: 100% 100%;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: title-glow 10s ease-in-out infinite;
}

.hero__descriptors {
  font-family: var(--font-body);
  font-size: var(--size-small);
  font-weight: 400;
  letter-spacing: var(--tracking-caps);
  text-transform: uppercase;
  color: var(--color-text-muted);
  margin-bottom: 2rem;
}

.hero__descriptors .dot {
  margin: 0 0.75em;
  color: var(--color-rule-light);
}

/* Ornamental rule with diamond centerpoint and flanking gradients */
.hero__rule {
  width: 120px;
  height: 1px;
  background: linear-gradient(to right, transparent, var(--color-rule) 30%, var(--color-rule) 70%, transparent);
  margin: 0 auto 2rem;
  position: relative;
}

.hero__rule::before {
  content: '';
  position: absolute;
  left: 50%;
  top: 50%;
  width: 7px;
  height: 7px;
  background: var(--color-rule);
  transform: translate(-50%, -50%) rotate(45deg);
}

.hero__tagline {
  font-family: var(--font-display);
  font-size: clamp(1.05rem, 1.5vw, 1.25rem);
  font-style: italic;
  font-weight: 300;
  line-height: 1.65;
  color: var(--color-text-soft);
  max-width: 480px;
  margin: 0 auto;
}

/* — Scroll Indicator — animated dot on a thin line */
.hero__scroll {
  position: absolute;
  bottom: 2.5rem;
  left: 50%;
  transform: translateX(-50%);
  width: 1px;
  height: 36px;
  background: var(--color-rule-faint);
  z-index: 1;
}

.hero__scroll-dot {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: var(--color-rule);
  animation: scroll-dot 2.4s ease-in-out infinite;
}


/* ============================================================
   ANIMATIONS
   ============================================================ */

/* Fade-in on scroll (only when JS is active) */
.fade-in {
  opacity: 1;
  transform: none;
}

html.js .fade-in {
  opacity: 0.84;
  transform: translateY(8px);
  transition: opacity 0.8s ease, transform 0.8s ease;
}

html.js .fade-in.visible {
  opacity: 1;
  transform: translateY(0);
}

/* Pulsing holographic glow */
@keyframes title-glow {
  0%, 100% {
    text-shadow: 0 0 25px rgba(180,149,69,0.10);
    filter: brightness(1);
  }
  35% {
    text-shadow:
      0 0 30px rgba(180,149,69,0.18),
      0 0 60px rgba(180,149,69,0.06);
    filter: brightness(1.02);
  }
  46% {
    text-shadow:
      0 0 20px rgba(140,100,220,0.18),
      0 0 40px rgba(80,180,255,0.12),
      0 0 60px rgba(180,149,69,0.08);
    filter: brightness(1.08);
  }
  50% {
    text-shadow:
      0 0 18px rgba(80,220,180,0.20),
      0 0 35px rgba(200,80,255,0.14),
      0 0 55px rgba(80,180,255,0.10),
      0 0 70px rgba(255,120,200,0.06);
    filter: brightness(1.12);
  }
  54% {
    text-shadow:
      0 0 20px rgba(255,140,180,0.16),
      0 0 40px rgba(120,80,220,0.12),
      0 0 60px rgba(180,149,69,0.08);
    filter: brightness(1.08);
  }
  65% {
    text-shadow:
      0 0 30px rgba(180,149,69,0.18),
      0 0 60px rgba(180,149,69,0.06);
    filter: brightness(1.02);
  }
}

/* Scroll dot drift */
@keyframes scroll-dot {
  0%   { top: 0;    opacity: 0; }
  20%  { opacity: 1; }
  80%  { opacity: 1; }
  100% { top: 32px; opacity: 0; }
}

/* Runtime pause toggled by JS when tab is hidden/offscreen */
.motion-paused .hero__title,
.motion-paused .hero__scroll-dot,
.motion-paused .marginalia__breathe,
.motion-paused .marginalia__drift,
.motion-paused .marginalia__pulse {
  animation-play-state: paused !important;
}


/* ============================================================
   REDUCED MOTION
   ============================================================ */
@media (prefers-reduced-motion: reduce) {
  .fade-in {
    transition: none;
    opacity: 1;
    transform: none;
  }
  .hero__scroll-dot {
    animation: none;
  }
  .hero__title {
    animation: none;
  }
}


/* ============================================================
   RESPONSIVE
   ============================================================ */

/* Tablet & below: single column */
@media (max-width: 900px) {
  :root {
    --frame: 12px;
    --inner-inset: 8px;
  }

  .section {
    height: 100%;
  }

  .page {
    border-width: 2px;
  }

  /* Simplify frame on tablet/mobile */
  .frame-corner,
  .frame-diamond {
    display: none;
  }
}

/* Small screens */
@media (max-width: 600px) {
  .site-rail {
    display: none;
  }

  :root {
    --frame: 8px;
    --inner-inset: 5px;
  }

  .page {
    border-width: 1px;
  }

  .section--hero {
    justify-content: start;
    padding-top: clamp(2rem, 8vh, 5rem);
  }

  .hero__title {
    letter-spacing: 0.15em;
  }

  .hero__cloud {
    width: 75vw;
    height: 75vw;
    margin-bottom: 0.5rem;
  }

  .hero__tagline {
    font-size: clamp(0.85rem, 3.5vw, 1.05rem);
    max-width: 85vw;
    padding: 0 0.5rem;
    line-height: 1.5;
  }

  .hero__descriptors {
    margin-bottom: 1rem;
  }

  .hero__rule {
    margin-bottom: 1rem;
  }
}
